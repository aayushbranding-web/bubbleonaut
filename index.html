<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Bubbleonaut ~AyTech Solution</title>
    
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka+One&display=swap');

        body {
            margin: 0;
            background-color: #000;
            overflow: hidden;
            touch-action: none;
            font-family: 'Fredoka One', cursive;
            user-select: none;
            -webkit-user-select: none;
        }

        #game-container {
            position: relative;
            width: 100vw; height: 100vh;
            /* Attractive Deep Space Gradient Background */
            background: radial-gradient(circle at center, #2a003d 0%, #000011 100%);
        }

        canvas { display: block; width: 100%; height: 100%; }

        /* --- UI & CONTROLS --- */
        #ui-layer {
            position: absolute; top: 20px; left: 20px; right: 20px;
            display: flex; justify-content: space-between; pointer-events: none; z-index: 10;
        }

        .hud-text {
            color: #fff; font-size: 20px;
            text-shadow: 2px 2px 0px #00aaff;
            background: rgba(255, 255, 255, 0.1);
            padding: 8px 15px; border-radius: 20px;
            border: 3px solid rgba(0, 170, 255, 0.5);
        }

        #controls {
            position: absolute; bottom: 60px; /* Moved up slightly for footer space */
            width: 100%; height: 120px;
            display: flex; justify-content: space-between; padding: 0 30px;
            box-sizing: border-box; z-index: 20; display: none;
        }

        .d-pad, .action-pad { display: flex; gap: 20px; align-items: flex-end; }

        .btn {
            width: 80px; height: 80px;
            border-radius: 50%;
            /* Glassy Bubble Buttons */
            background: radial-gradient(circle at 30% 30%, rgba(255,255,255,0.4), rgba(0,150,255,0.1));
            border: 3px solid rgba(0, 200, 255, 0.5);
            box-shadow: inset 0 0 15px rgba(0,200,255,0.3);
            backdrop-filter: blur(5px);
            display: flex; justify-content: center; align-items: center;
            color: #fff; font-size: 30px; touch-action: none; pointer-events: auto;
        }

        .btn:active { transform: scale(0.9); background: rgba(0, 255, 255, 0.3); }
        .btn-fire { 
            border-color: rgba(255, 100, 150, 0.5); 
            background: radial-gradient(circle at 30% 30%, rgba(255,200,200,0.4), rgba(255,0,100,0.1)); 
        }

        /* --- START SCREEN --- */
        #overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: rgba(0,0,17,0.9);
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            z-index: 100; text-align: center;
        }

        h1 { font-size: 45px; color: #0ff; text-shadow: 3px 3px #f0f; margin-bottom: 10px; }
        .start-btn {
            margin-top: 30px; padding: 15px 40px; font-size: 24px;
            background: #0ff; color: #000; border: none; border-radius: 30px;
            font-family: 'Fredoka One', cursive; cursor: pointer;
            box-shadow: 0 10px 0 #0077aa; transition: all 0.1s;
        }
        .start-btn:active { transform: translateY(5px); box-shadow: 0 5px 0 #0077aa; }

        @media (max-width: 768px) { #controls { display: flex; } h1 { font-size: 35px; } }

        /* --- FOOTER STYLES --- */
        #game-footer {
            position: fixed;
            bottom: 0; left: 0; width: 100%;
            background-color: rgba(20, 20, 30, 0.95);
            color: #ccc;
            padding: 8px 0;
            display: flex; justify-content: center; align-items: center;
            font-family: sans-serif; font-size: 12px;
            z-index: 1000;
            border-top: 2px solid #00aaff;
        }
        .footer-content { display: flex; align-items: center; }
    </style>
</head>
<body>

<div id="game-container">
    <canvas id="gameCanvas"></canvas>
    <div id="ui-layer">
        <div class="hud-text" id="scoreEl">SCORE: 0</div>
        <div class="hud-text" id="livesEl">Done: 3</div>
    </div>
    <div id="controls">
        <div class="d-pad">
            <div class="btn" id="btn-left">←</div>
            <div class="btn" id="btn-right">→</div>
        </div>
        <div class="action-pad">
            <div class="btn" id="btn-thrust">↑</div>
            <div class="btn btn-fire" id="btn-shoot">◎</div>
        </div>
    </div>
    <div id="overlay">
        <h1 id="title-text"> BUBBLEONAUT<br>
            <span style="font-size: 24px; color: #fff; display: block; margin-top: 5px;">~AyTech Solution</span>
        </h1>
        <p style="color:#aaa; font-family: sans-serif;">Arrow Keys/WASD to Move • Space to Shoot</p>
        <button class="start-btn" id="start-btn">PLAY!</button>
    </div>
</div>

<div id="game-footer">
    <div class="footer-content">
        <span>Made by <strong>AyTech Solution</strong> | 2025 Copyright. All rights reserved.</span>
    </div>
</div>

<script>
    // --- AUDIO ENGINE ---
    const AudioEngine = {
        ctx: null,
        init: function() { 
            if (!this.ctx) { 
                this.ctx = new (window.AudioContext || window.webkitAudioContext)(); 
                this.ctx.resume(); 
            } 
        },
        play: function(type) {
            if (!this.ctx) return;
            const t = this.ctx.currentTime;
            const osc = this.ctx.createOscillator();
            const gain = this.ctx.createGain();
            osc.connect(gain); gain.connect(this.ctx.destination);

            if (type === 'shoot') {
                osc.type = 'sine';
                osc.frequency.setValueAtTime(300, t);
                osc.frequency.exponentialRampToValueAtTime(800, t + 0.1);
                gain.gain.setValueAtTime(0.5, t);
                gain.gain.exponentialRampToValueAtTime(0.01, t + 0.15);
                osc.start(t); osc.stop(t + 0.15);
            } else if (type === 'thrust') {
                osc.type = 'triangle';
                osc.frequency.setValueAtTime(100, t);
                gain.gain.setValueAtTime(0.3, t);
                gain.gain.linearRampToValueAtTime(0, t + 0.1);
                osc.start(t); osc.stop(t + 0.1);
            } else if (type === 'explode') {
                osc.type = 'sine';
                osc.frequency.setValueAtTime(150, t);
                osc.frequency.exponentialRampToValueAtTime(20, t + 0.2);
                gain.gain.setValueAtTime(0.8, t);
                gain.gain.exponentialRampToValueAtTime(0.01, t + 0.2);
                osc.start(t); osc.stop(t + 0.2);
            }
        }
    };

    // --- SETUP ---
    const canvas = document.getElementById('gameCanvas');
    const ctx = canvas.getContext('2d');
    function resize() { canvas.width = window.innerWidth; canvas.height = window.innerHeight; }
    window.addEventListener('resize', resize); resize();

    const scoreEl = document.getElementById('scoreEl');
    const livesEl = document.getElementById('livesEl');
    const overlay = document.getElementById('overlay');
    const startBtn = document.getElementById('start-btn');
    const titleText = document.getElementById('title-text');

    const FPS = 60; const SHIP_SIZE = 20; const TURN_SPEED = 250; const THRUST = 15; const FRICTION = 0.96;
    let gameRunning = false; let score = 0; let lives = 3; let level = 1;
    const ship = { x:0, y:0, a:0, xv:0, yv:0, dead:false, blink:0, cd:0 };
    let asteroids = []; let lasers = []; let particles = [];
    const input = { up: false, left: false, right: false, shoot: false };

    // --- INPUTS ---
    const setKey = (k, s) => { 
        if('ArrowUp'===k||'w'===k||'W'===k) input.up=s; 
        if('ArrowLeft'===k||'a'===k||'A'===k) input.left=s; 
        if('ArrowRight'===k||'d'===k||'D'===k) input.right=s; 
        if('Space'===k||'Enter'===k||' '===k) input.shoot=s; 
    };
    window.addEventListener('keydown', e => setKey(e.key, true)); 
    window.addEventListener('keyup', e => setKey(e.key, false));

    const bindTouch = (id, prop) => { 
        const btn=document.getElementById(id); 
        const s=(e)=>{e.preventDefault(); input[prop]=true;}; 
        const n=(e)=>{e.preventDefault(); input[prop]=false;}; 
        btn.addEventListener('touchstart',s, {passive: false}); 
        btn.addEventListener('touchend',n); 
        btn.addEventListener('mousedown',s); 
        btn.addEventListener('mouseup',n); 
    };
    bindTouch('btn-left','left'); bindTouch('btn-right','right'); bindTouch('btn-thrust','up'); bindTouch('btn-shoot','shoot');

    // --- GAME LOOP ---
    startBtn.addEventListener('click', () => { AudioEngine.init(); initGame(); });

    function initGame() { 
        overlay.style.display='none'; gameRunning=true; score=0; lives=3; level=1; 
        scoreEl.innerText="SCORE: 0"; livesEl.innerText="LIVES: 3"; resetLevel(); loop(); 
    }

    function resetLevel() { 
        ship.x=canvas.width/2; ship.y=canvas.height/2; ship.xv=0; ship.yv=0; ship.a=-Math.PI/2; 
        ship.dead=false; ship.blink=120; asteroids=[]; lasers=[]; particles=[];
        for(let i=0; i<2+level; i++) {
            let x, y, d; 
            do { x=Math.random()*canvas.width; y=Math.random()*canvas.height; d=Math.hypot(x-ship.x, y-ship.y); } while(d<250);
            asteroids.push({ 
                x, y, xv:(Math.random()-0.5)*(3+level), yv:(Math.random()-0.5)*(3+level), 
                r:45+Math.random()*20, rot: Math.random()*Math.PI, rSpd: (Math.random()-0.5)*0.05 
            });
        }
    }

    function update() {
        if(!gameRunning) return;
        
        // Ship Logic
        if(!ship.dead) {
            if(input.left) ship.a -= (TURN_SPEED*Math.PI/180)/FPS; 
            if(input.right) ship.a += (TURN_SPEED*Math.PI/180)/FPS;
            
            if(input.up) { 
                ship.xv += THRUST*Math.cos(ship.a)/FPS; 
                ship.yv += THRUST*Math.sin(ship.a)/FPS; 
                if(Math.random()<0.2) AudioEngine.play('thrust');
                
                // Thrust Bubbles
                for(let i=0;i<2;i++) particles.push({
                    x:ship.x-Math.cos(ship.a)*15, y:ship.y-Math.sin(ship.a)*15, 
                    xv:(Math.random()-0.5)*3, yv:(Math.random()-0.5)*3, 
                    life:15, color:'rgba(100,200,255,0.5)', type:'bubble'
                });
            } else { 
                ship.xv *= FRICTION; ship.yv *= FRICTION; 
            }
            
            ship.x += ship.xv; ship.y += ship.yv;
            if(ship.cd > 0) ship.cd--;
            
            if(input.shoot && ship.cd <= 0) { 
                lasers.push({
                    x:ship.x+Math.cos(ship.a)*25, y:ship.y+Math.sin(ship.a)*25, 
                    xv:Math.cos(ship.a)*500, yv:Math.sin(ship.a)*500, life:90, r: 12
                }); 
                AudioEngine.play('shoot'); ship.cd = 15; 
            }
        }
        wrap(ship, SHIP_SIZE);

        // Lasers Logic
        for(let i=lasers.length-1; i>=0; i--) { 
            lasers[i].x += lasers[i].xv/FPS; lasers[i].y += lasers[i].yv/FPS; 
            lasers[i].life--; wrap(lasers[i], 0); 
            if(lasers[i].life<=0) lasers.splice(i,1); 
        }

        // Asteroids Logic
        if(asteroids.length===0) { level++; resetLevel(); }
        
        for(let i=asteroids.length-1; i>=0; i--) { 
            let a = asteroids[i]; 
            a.x += a.xv; a.y += a.yv; a.rot += a.rSpd; 
            wrap(a, a.r);

            // Collision: Laser vs Asteroid
            for(let j=lasers.length-1; j>=0; j--) { 
                let l = lasers[j]; 
                if(Math.hypot(a.x-l.x, a.y-l.y) < a.r+l.r) {
                    AudioEngine.play('explode'); 
                    lasers.splice(j,1); asteroids.splice(i,1);
                    
                    // Explosion particles
                    for(let p=0; p<15; p++) particles.push({
                        x:a.x, y:a.y, xv:(Math.random()-0.5)*8, yv:(Math.random()-0.5)*8, 
                        life:30, color:'rgba(255,100,200,0.8)', type:'pop'
                    });
                    
                    score += 100; scoreEl.innerText="SCORE: "+score;
                    
                    // Split Asteroid
                    if(a.r > 30) { 
                        asteroids.push({x:a.x,y:a.y,xv:Math.random()*4-2,yv:Math.random()*4-2,r:a.r/1.8, rot:0, rSpd:a.rSpd*1.5}); 
                        asteroids.push({x:a.x,y:a.y,xv:Math.random()*4-2,yv:Math.random()*4-2,r:a.r/1.8, rot:0, rSpd:-a.rSpd*1.5}); 
                    }
                    break;
                }
            }

            // Collision: Ship vs Asteroid
            if(!ship.dead && ship.blink<=0 && asteroids[i]) {
                if(Math.hypot(a.x-ship.x, a.y-ship.y) < a.r+SHIP_SIZE-5) {
                    AudioEngine.play('explode'); ship.dead=true; lives--; livesEl.innerText="LIVES: "+lives;
                    
                    for(let p=0; p<30; p++) particles.push({
                        x:ship.x, y:ship.y, xv:(Math.random()-0.5)*10, yv:(Math.random()-0.5)*10, 
                        life:50, color:'#fff', type:'pop'
                    });

                    if(lives > 0) {
                        setTimeout(()=> {
                            ship.dead=false; ship.x=canvas.width/2; ship.y=canvas.height/2; 
                            ship.xv=0; ship.yv=0; ship.blink=150;
                        }, 1500);
                    } else {
                        setTimeout(()=> {
                            gameRunning=false; titleText.innerText="GAME OVER"; 
                            startBtn.innerText="RETRY"; overlay.style.display='flex';
                        }, 1500);
                    }
                }
            }
        }

        // Particles Logic
        for(let i=particles.length-1; i>=0; i--) { 
            particles[i].x += particles[i].xv; particles[i].y += particles[i].yv; 
            particles[i].life--; 
            if(particles[i].life<=0) particles.splice(i,1); 
        }
        
        if(ship.blink>0) ship.blink--;
    }

    const wrap = (o,p) => {
        if(o.x < -p) o.x = canvas.width + p;
        if(o.x > canvas.width + p) o.x = -p;
        if(o.y < -p) o.y = canvas.height + p;
        if(o.y > canvas.height + p) o.y = -p;
    };

    // --- DRAWING ---
    function draw() {
        ctx.clearRect(0, 0, canvas.width, canvas.height);

        // Draw Lasers
        lasers.forEach(l => {
            drawBubble(l.x, l.y, l.r, 'rgba(0,200,255,0.6)', 'rgba(200,255,255,0.8)');
        });

        // Draw Player
        if(!ship.dead && Math.floor(ship.blink/10)%2===0) {
            ctx.save(); ctx.translate(ship.x, ship.y); ctx.rotate(ship.a + Math.PI/2); 
            ctx.fillStyle = '#eee'; ctx.fillRect(-12, -10, 24, 22); 
            ctx.fillStyle = '#ccc'; ctx.fillRect(-14, -8, 4, 18); ctx.fillRect(10, -8, 4, 18); 
            ctx.fillStyle = '#00aaff'; ctx.beginPath(); ctx.arc(0, -10, 10, 0, Math.PI*2); ctx.fill();
            ctx.fillStyle = 'rgba(255,255,255,0.8)'; ctx.beginPath(); ctx.arc(-4, -14, 3, 0, Math.PI*2); ctx.fill();
            ctx.fillStyle = '#ff66aa'; ctx.fillRect(12, -2, 12, 8); 
            ctx.restore();
        }

        // Draw Asteroids
        asteroids.forEach(a => {
            ctx.save(); ctx.translate(a.x, a.y); ctx.rotate(a.rot);
            ctx.fillStyle = '#776688'; ctx.beginPath();
            for(let i=0; i<6; i++) { 
                let angle=(i/6)*Math.PI*2; 
                let r=a.r*(0.6 + 0.2*Math.cos(i*2)); 
                ctx.lineTo(r*Math.cos(angle), r*Math.sin(angle)); 
            }
            ctx.fill();
            drawBubble(0,0, a.r, 'rgba(255,100,200,0.3)', 'rgba(255,200,220,0.6)');
            ctx.restore();
        });

        // Draw Particles
        particles.forEach(p => {
            ctx.globalAlpha = p.life/50;
            if(p.type === 'bubble') drawBubble(p.x, p.y, 5, p.color, '#fff');
            else { ctx.fillStyle = p.color; ctx.beginPath(); ctx.arc(p.x, p.y, 4, 0, Math.PI*2); ctx.fill(); }
            ctx.globalAlpha = 1;
        });
    }

    function drawBubble(x, y, r, mainColor, shineColor) {
        ctx.fillStyle = mainColor; ctx.beginPath(); ctx.arc(x, y, r, 0, Math.PI*2); ctx.fill();
        ctx.strokeStyle = shineColor; ctx.lineWidth=2; ctx.beginPath(); ctx.arc(x, y, r-1, -Math.PI/4, Math.PI); ctx.stroke();
        ctx.fillStyle = shineColor; ctx.beginPath(); ctx.arc(x - r*0.3, y - r*0.3, r*0.25, 0, Math.PI*2); ctx.fill();
    }

    function loop() { update(); draw(); requestAnimationFrame(loop); }
</script>

</body>
</html>
